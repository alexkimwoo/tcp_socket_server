#=======================================================================================================================
import socket_server
import datetime
import time
import thread
#=======================================================================================================================
value = 0
#=======================================================================================================================
def now():
    return datetime.datetime.now().strftime('%Y.%m.%d %H:%M:%S')
#=======================================================================================================================
def count():
    global value
    value += 1
    return value
#=======================================================================================================================
def server_business(name, delay):

    while True:
        b = socket_server.Business()
        resp_ping = 'pong'
        resp_time = now()
        resp_r = str(count())

        rules_result = (['ping', resp_ping],['time', resp_time],['r', resp_r])
        b.refresh_data(rules_result)
        time.sleep(delay)
#=======================================================================================================================
try:
    thread.start_new_thread(server_business, ("SERVER_BUSINESS", 0.5, ) )
except Exception,err:
    print '%s' % str(err)
#=======================================================================================================================
socket_server.myServer(port=9000)
#=======================================================================================================================
while True:
   pass